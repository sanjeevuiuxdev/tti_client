{
    "sourceFile": "components/headers/Nav.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 6,
            "patches": [
                {
                    "date": 1762021447524,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762021524970,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -75,11 +75,11 @@\n         <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n           <span className=\"text\" data-splitting=\"\">\r\n             Home\r\n           </span>\r\n-          {/* <span className=\"text\" data-splitting=\"\">\r\n+          <span className=\"text\" data-splitting=\"\">\r\n             Home\r\n-          </span> */}\r\n+          </span>\r\n         </a>\r\n         <ul className=\"submenu\">\r\n           {homePages.map(({ href, label }) => (\r\n             <li\r\n"
                },
                {
                    "date": 1762021596448,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,9 +79,9 @@\n           <span className=\"text\" data-splitting=\"\">\r\n             Home\r\n           </span>\r\n         </a>\r\n-        <ul className=\"submenu\">\r\n+        {/* <ul className=\"submenu\">\r\n           {homePages.map(({ href, label }) => (\r\n             <li\r\n               key={href}\r\n               className={`menu-item ${\r\n@@ -90,9 +90,9 @@\n             >\r\n               <Link href={href}>{label}</Link>\r\n             </li>\r\n           ))}\r\n-        </ul>\r\n+        </ul> */}\r\n       </li>\r\n \r\n       {/* Features */}\r\n       <li\r\n"
                },
                {
                    "date": 1762021675261,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -65,9 +65,9 @@\n   return (\r\n     <>\r\n       {/* Home */}\r\n       <li\r\n-        className={`has-child text-menu ${\r\n+        className={` text-menu ${\r\n           isMenuParentActive(homePages) ? \"current-menu\" : \"\"\r\n         }`}\r\n         onMouseEnter={handleEnter}\r\n         onMouseLeave={handleLeave}\r\n"
                },
                {
                    "date": 1762530219414,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         onMouseLeave={handleLeave}\r\n       >\r\n         <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n           <span className=\"text\" data-splitting=\"\">\r\n-            Home\r\n+            Homecxzcx\r\n           </span>\r\n           <span className=\"text\" data-splitting=\"\">\r\n             Home\r\n           </span>\r\n"
                },
                {
                    "date": 1762530273043,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -73,9 +73,9 @@\n         onMouseLeave={handleLeave}\r\n       >\r\n         <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n           <span className=\"text\" data-splitting=\"\">\r\n-            Homecxzcx\r\n+            Home\r\n           </span>\r\n           <span className=\"text\" data-splitting=\"\">\r\n             Home\r\n           </span>\r\n"
                },
                {
                    "date": 1762542519093,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,162 +1,103 @@\n \"use client\";\r\n import Link from \"next/link\";\r\n import React, { useEffect, useRef, useState } from \"react\";\r\n-import {\r\n-  categoryLinks,\r\n-  categoryLinks2,\r\n-  homePages,\r\n-  singlePostLinks,\r\n-} from \"@/data/menu\";\r\n+import { homePages } from \"@/data/menu\";\r\n import { usePathname } from \"next/navigation\";\r\n import { MenuItem } from \"@/types/menu-item\";\r\n \r\n+type Category = {\r\n+  _id: string;\r\n+  name: string;\r\n+  slug: string;\r\n+};\r\n+\r\n export default function Nav() {\r\n   const pathname = usePathname();\r\n   const [overlayEnabled, setOverlayEnabled] = useState(false);\r\n+  const [cats, setCats] = useState<Category[]>([]);\r\n   const splittingLoadedRef = useRef(false);\r\n \r\n+  // load Splitting only once (CSR)\r\n   useEffect(() => {\r\n     let cancelled = false;\r\n-\r\n-    // already initialized? bail out\r\n     if (splittingLoadedRef.current) return;\r\n-\r\n-    // defer slightly so Bootstrap JS (tooltips/popovers, etc.) can attach first\r\n     const timer = setTimeout(async () => {\r\n       try {\r\n-        const mod = await import(\"splitting\"); // dynamic import (CSR only)\r\n+        const mod = await import(\"splitting\");\r\n         if (cancelled) return;\r\n-\r\n-        // call Splitting (supports both default and named export shapes)\r\n         const Splitting = (mod as any).default ?? (mod as any);\r\n         Splitting();\r\n         splittingLoadedRef.current = true;\r\n-      } catch (err) {\r\n-        // optional: log or handle\r\n-        // console.error(\"Failed to load Splitting\", err);\r\n-      }\r\n+      } catch {}\r\n     }, 0);\r\n-\r\n     return () => {\r\n       cancelled = true;\r\n       clearTimeout(timer);\r\n     };\r\n   }, []);\r\n \r\n-  // Add/remove body class depending on overlayEnabled\r\n+  // overlay class toggle\r\n   useEffect(() => {\r\n-    if (overlayEnabled) {\r\n-      document.body.classList.add(\"menu-overlay-enabled\");\r\n-    } else {\r\n-      document.body.classList.remove(\"menu-overlay-enabled\");\r\n-    }\r\n+    if (overlayEnabled) document.body.classList.add(\"menu-overlay-enabled\");\r\n+    else document.body.classList.remove(\"menu-overlay-enabled\");\r\n   }, [overlayEnabled]);\r\n \r\n+  // fetch dynamic categories\r\n+  useEffect(() => {\r\n+    const ctrl = new AbortController();\r\n+    const API = process.env.NEXT_PUBLIC_API_BASE!;\r\n+    fetch(`${API}/api/categories`, { signal: ctrl.signal })\r\n+      .then(async (r) => {\r\n+        if (!r.ok) throw new Error(await r.text());\r\n+        return r.json();\r\n+      })\r\n+      .then((rows: Category[]) => setCats(rows))\r\n+      .catch(() => {});\r\n+    return () => ctrl.abort();\r\n+  }, []);\r\n+\r\n   const isMenuActive = (link: { href: string }) =>\r\n     link.href?.split(\"/\")[1] == pathname.split(\"/\")[1];\r\n \r\n   const isMenuParentActive = (menu: MenuItem[]) =>\r\n     menu.some((elm) => isMenuActive(elm));\r\n \r\n-  // shared handlers\r\n   const handleEnter = () => setOverlayEnabled(true);\r\n   const handleLeave = () => setOverlayEnabled(false);\r\n \r\n   return (\r\n     <>\r\n-      {/* Home */}\r\n+      {/* Home (simple link) */}\r\n       <li\r\n-        className={` text-menu ${\r\n-          isMenuParentActive(homePages) ? \"current-menu\" : \"\"\r\n-        }`}\r\n-        onMouseEnter={handleEnter}\r\n-        onMouseLeave={handleLeave}\r\n+        className={`text-menu ${isMenuActive({ href: \"/\" }) ? \"current-menu\" : \"\"}`}\r\n       >\r\n-        <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n+        <Link href={`/`} className=\"toggle splitting\">\r\n           <span className=\"text\" data-splitting=\"\">\r\n             Home\r\n           </span>\r\n           <span className=\"text\" data-splitting=\"\">\r\n             Home\r\n           </span>\r\n-        </a>\r\n-        {/* <ul className=\"submenu\">\r\n-          {homePages.map(({ href, label }) => (\r\n-            <li\r\n-              key={href}\r\n-              className={`menu-item ${\r\n-                isMenuActive({ href }) ? \" current-menu-item\" : \"\"\r\n-              }`}\r\n-            >\r\n-              <Link href={href}>{label}</Link>\r\n-            </li>\r\n-          ))}\r\n-        </ul> */}\r\n+        </Link>\r\n       </li>\r\n \r\n-      {/* Features */}\r\n+      {/* All posts (replaces Features dropdown) */}\r\n       <li\r\n-        className={`has-child text-menu ${\r\n-          isMenuParentActive(categoryLinks) ? \"current-menu\" : \"\"\r\n-        }`}\r\n-        onMouseEnter={handleEnter}\r\n-        onMouseLeave={handleLeave}\r\n+        className={`text-menu ${isMenuActive({ href: \"/categories-2\" }) ? \"current-menu\" : \"\"}`}\r\n       >\r\n-        <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n+        <Link href={`/categories-2`} className=\"toggle splitting\">\r\n           <span className=\"text\" data-splitting=\"\">\r\n-            Features\r\n+            All posts\r\n           </span>\r\n           <span className=\"text\" data-splitting=\"\">\r\n-            Features\r\n+            All posts\r\n           </span>\r\n-        </a>\r\n-        <ul className=\"submenu\">\r\n-          {categoryLinks.map(({ href, label }) => (\r\n-            <li\r\n-              key={href}\r\n-              className={`menu-item ${\r\n-                isMenuActive({ href }) ? \" current-menu-item\" : \"\"\r\n-              }`}\r\n-            >\r\n-              <Link href={href}>{label}</Link>\r\n-            </li>\r\n-          ))}\r\n-        </ul>\r\n+        </Link>\r\n       </li>\r\n \r\n-      {/* Post Styles */}\r\n+      {/* Categories (dynamic dropdown) */}\r\n       <li\r\n-        className={`has-child text-menu ${\r\n-          isMenuParentActive(singlePostLinks) ? \"current-menu\" : \"\"\r\n-        }`}\r\n-        onMouseEnter={handleEnter}\r\n-        onMouseLeave={handleLeave}\r\n-      >\r\n-        <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n-          <span className=\"text\" data-splitting=\"\">\r\n-            Post Styles\r\n-          </span>\r\n-          <span className=\"text\" data-splitting=\"\">\r\n-            Post Styles\r\n-          </span>\r\n-        </a>\r\n-        <ul className=\"submenu\">\r\n-          {singlePostLinks.map(({ href, label }) => (\r\n-            <li\r\n-              key={href}\r\n-              className={`menu-item ${\r\n-                isMenuActive({ href }) ? \" current-menu-item\" : \"\"\r\n-              }`}\r\n-            >\r\n-              <Link href={href}>{label}</Link>\r\n-            </li>\r\n-          ))}\r\n-        </ul>\r\n-      </li>\r\n-\r\n-      {/* Categories */}\r\n-      <li\r\n         className=\"has-child text-menu\"\r\n         onMouseEnter={handleEnter}\r\n         onMouseLeave={handleLeave}\r\n       >\r\n@@ -168,22 +109,26 @@\n             Categories\r\n           </span>\r\n         </a>\r\n         <ul className=\"submenu\">\r\n-          {categoryLinks2.map(({ href, label, slug }) => (\r\n-            <li key={label} className=\"menu-item\">\r\n-              <Link href={`${href}/${slug}`}>{label}</Link>\r\n+          {cats.length ? (\r\n+            cats.map((c) => (\r\n+              <li key={c._id} className=\"menu-item\">\r\n+                <Link href={`/categories/${c.slug}`}>{c.name}</Link>\r\n+              </li>\r\n+            ))\r\n+          ) : (\r\n+            <li className=\"menu-item\">\r\n+              <span style={{ opacity: 0.6, padding: \"8px 16px\", display: \"block\" }}>\r\n+                Loadingâ€¦\r\n+              </span>\r\n             </li>\r\n-          ))}\r\n+          )}\r\n         </ul>\r\n       </li>\r\n \r\n       {/* About */}\r\n-      <li\r\n-        className={`text-menu ${\r\n-          isMenuActive({ href: \"/about\" }) ? \" current-menu\" : \"\"\r\n-        }`}\r\n-      >\r\n+      <li className={`text-menu ${isMenuActive({ href: \"/about\" }) ? \" current-menu\" : \"\"}`}>\r\n         <Link href={`/about`} className=\"toggle splitting\">\r\n           <span className=\"text\" data-splitting=\"\">\r\n             About\r\n           </span>\r\n@@ -193,13 +138,9 @@\n         </Link>\r\n       </li>\r\n \r\n       {/* Contact */}\r\n-      <li\r\n-        className={`text-menu ${\r\n-          isMenuActive({ href: \"/contact\" }) ? \" current-menu\" : \"\"\r\n-        }`}\r\n-      >\r\n+      <li className={`text-menu ${isMenuActive({ href: \"/contact\" }) ? \" current-menu\" : \"\"}`}>\r\n         <Link href={`/contact`} className=\"toggle splitting\">\r\n           <span className=\"text\" data-splitting=\"\">\r\n             Contact\r\n           </span>\r\n"
                }
            ],
            "date": 1762021447524,
            "name": "Commit-0",
            "content": "\"use client\";\r\nimport Link from \"next/link\";\r\nimport React, { useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  categoryLinks,\r\n  categoryLinks2,\r\n  homePages,\r\n  singlePostLinks,\r\n} from \"@/data/menu\";\r\nimport { usePathname } from \"next/navigation\";\r\nimport { MenuItem } from \"@/types/menu-item\";\r\n\r\nexport default function Nav() {\r\n  const pathname = usePathname();\r\n  const [overlayEnabled, setOverlayEnabled] = useState(false);\r\n  const splittingLoadedRef = useRef(false);\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n\r\n    // already initialized? bail out\r\n    if (splittingLoadedRef.current) return;\r\n\r\n    // defer slightly so Bootstrap JS (tooltips/popovers, etc.) can attach first\r\n    const timer = setTimeout(async () => {\r\n      try {\r\n        const mod = await import(\"splitting\"); // dynamic import (CSR only)\r\n        if (cancelled) return;\r\n\r\n        // call Splitting (supports both default and named export shapes)\r\n        const Splitting = (mod as any).default ?? (mod as any);\r\n        Splitting();\r\n        splittingLoadedRef.current = true;\r\n      } catch (err) {\r\n        // optional: log or handle\r\n        // console.error(\"Failed to load Splitting\", err);\r\n      }\r\n    }, 0);\r\n\r\n    return () => {\r\n      cancelled = true;\r\n      clearTimeout(timer);\r\n    };\r\n  }, []);\r\n\r\n  // Add/remove body class depending on overlayEnabled\r\n  useEffect(() => {\r\n    if (overlayEnabled) {\r\n      document.body.classList.add(\"menu-overlay-enabled\");\r\n    } else {\r\n      document.body.classList.remove(\"menu-overlay-enabled\");\r\n    }\r\n  }, [overlayEnabled]);\r\n\r\n  const isMenuActive = (link: { href: string }) =>\r\n    link.href?.split(\"/\")[1] == pathname.split(\"/\")[1];\r\n\r\n  const isMenuParentActive = (menu: MenuItem[]) =>\r\n    menu.some((elm) => isMenuActive(elm));\r\n\r\n  // shared handlers\r\n  const handleEnter = () => setOverlayEnabled(true);\r\n  const handleLeave = () => setOverlayEnabled(false);\r\n\r\n  return (\r\n    <>\r\n      {/* Home */}\r\n      <li\r\n        className={`has-child text-menu ${\r\n          isMenuParentActive(homePages) ? \"current-menu\" : \"\"\r\n        }`}\r\n        onMouseEnter={handleEnter}\r\n        onMouseLeave={handleLeave}\r\n      >\r\n        <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Home\r\n          </span>\r\n          {/* <span className=\"text\" data-splitting=\"\">\r\n            Home\r\n          </span> */}\r\n        </a>\r\n        <ul className=\"submenu\">\r\n          {homePages.map(({ href, label }) => (\r\n            <li\r\n              key={href}\r\n              className={`menu-item ${\r\n                isMenuActive({ href }) ? \" current-menu-item\" : \"\"\r\n              }`}\r\n            >\r\n              <Link href={href}>{label}</Link>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </li>\r\n\r\n      {/* Features */}\r\n      <li\r\n        className={`has-child text-menu ${\r\n          isMenuParentActive(categoryLinks) ? \"current-menu\" : \"\"\r\n        }`}\r\n        onMouseEnter={handleEnter}\r\n        onMouseLeave={handleLeave}\r\n      >\r\n        <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Features\r\n          </span>\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Features\r\n          </span>\r\n        </a>\r\n        <ul className=\"submenu\">\r\n          {categoryLinks.map(({ href, label }) => (\r\n            <li\r\n              key={href}\r\n              className={`menu-item ${\r\n                isMenuActive({ href }) ? \" current-menu-item\" : \"\"\r\n              }`}\r\n            >\r\n              <Link href={href}>{label}</Link>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </li>\r\n\r\n      {/* Post Styles */}\r\n      <li\r\n        className={`has-child text-menu ${\r\n          isMenuParentActive(singlePostLinks) ? \"current-menu\" : \"\"\r\n        }`}\r\n        onMouseEnter={handleEnter}\r\n        onMouseLeave={handleLeave}\r\n      >\r\n        <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Post Styles\r\n          </span>\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Post Styles\r\n          </span>\r\n        </a>\r\n        <ul className=\"submenu\">\r\n          {singlePostLinks.map(({ href, label }) => (\r\n            <li\r\n              key={href}\r\n              className={`menu-item ${\r\n                isMenuActive({ href }) ? \" current-menu-item\" : \"\"\r\n              }`}\r\n            >\r\n              <Link href={href}>{label}</Link>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </li>\r\n\r\n      {/* Categories */}\r\n      <li\r\n        className=\"has-child text-menu\"\r\n        onMouseEnter={handleEnter}\r\n        onMouseLeave={handleLeave}\r\n      >\r\n        <a href=\"#\" className=\"toggle splitting link-no-action\">\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Categories\r\n          </span>\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Categories\r\n          </span>\r\n        </a>\r\n        <ul className=\"submenu\">\r\n          {categoryLinks2.map(({ href, label, slug }) => (\r\n            <li key={label} className=\"menu-item\">\r\n              <Link href={`${href}/${slug}`}>{label}</Link>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n      </li>\r\n\r\n      {/* About */}\r\n      <li\r\n        className={`text-menu ${\r\n          isMenuActive({ href: \"/about\" }) ? \" current-menu\" : \"\"\r\n        }`}\r\n      >\r\n        <Link href={`/about`} className=\"toggle splitting\">\r\n          <span className=\"text\" data-splitting=\"\">\r\n            About\r\n          </span>\r\n          <span className=\"text\" data-splitting=\"\">\r\n            About\r\n          </span>\r\n        </Link>\r\n      </li>\r\n\r\n      {/* Contact */}\r\n      <li\r\n        className={`text-menu ${\r\n          isMenuActive({ href: \"/contact\" }) ? \" current-menu\" : \"\"\r\n        }`}\r\n      >\r\n        <Link href={`/contact`} className=\"toggle splitting\">\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Contact\r\n          </span>\r\n          <span className=\"text\" data-splitting=\"\">\r\n            Contact\r\n          </span>\r\n        </Link>\r\n      </li>\r\n    </>\r\n  );\r\n}\r\n"
        }
    ]
}