{
    "sourceFile": "app/blog/[slug]/page.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 12,
            "patches": [
                {
                    "date": 1762454339262,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1762455311504,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,186 +1,143 @@\n // app/blog/[slug]/page.tsx\n+import Link from \"next/link\";\n import Image from \"next/image\";\n-import Link from \"next/link\";\n import { notFound } from \"next/navigation\";\n \n import Header1 from \"@/components/headers/Header1\";\n import Footer1 from \"@/components/footers/Footer1\";\n import Sidebar from \"@/components/blog-single/Sidebar\";\n import SocialShare2 from \"@/components/blog-single/SocialShare2\";\n-import Comment from \"@/components/blog-single/Comment\";\n-import BlogCard1 from \"@/components/blog-cards/BlogCard1\";\n+import RelatedBlogs from \"@/components/blog-single/RelatedBlogs\";\n \n type Blog = {\n   _id: string;\n   slug: string;\n   title: string;\n   postedBy?: string;\n   mainImage?: { url?: string };\n-  category?: { name?: string; slug?: string; _id?: string };\n-  contentHtml?: string;\n+  contentHtml: string;\n+  category?: { name: string; slug?: string };\n   createdAt?: string;\n-  metaTitle?: string;\n-  metaDescription?: string;\n };\n \n const API = process.env.NEXT_PUBLIC_API_BASE!;\n \n-// ---- helpers ----\n-async function fetchJSON<T>(url: string, revalidate = 120): Promise<T> {\n-  const res = await fetch(url, { next: { revalidate } });\n-  if (res.status === 404) throw new Error(\"404\");\n-  if (!res.ok) throw new Error(await res.text());\n-  return res.json();\n+async function getBlog(slug: string): Promise<Blog | null> {\n+  const r = await fetch(`${API}/api/blogs/${slug}`, { cache: \"no-store\" });\n+  if (!r.ok) return null;\n+  return r.json();\n }\n \n-function toCardPost(b: Blog) {\n-  const imageUrl = b.mainImage?.url || \"\";\n-  return {\n-    id: b._id,                 // widget may read id but we link with slug\n-    slug: b.slug,\n-    href: `/blog/${b.slug}`,\n-    title: b.title,\n-    author: b.postedBy || \"\",\n-    date: new Date(b.createdAt || \"\").toDateString(),\n-    category: b.category?.name || \"\",\n-    imgSrc: imageUrl,\n-    image: imageUrl,\n-    img: imageUrl,\n-    thumb: imageUrl,\n-  };\n+// simple related by same category (exclude current)\n+async function getRelated(categorySlug?: string, currentSlug?: string) {\n+  if (!categorySlug) return [];\n+  const r = await fetch(\n+    `${API}/api/blogs?category=${encodeURIComponent(categorySlug)}&limit=6`,\n+    { cache: \"no-store\" }\n+  );\n+  if (!r.ok) return [];\n+  const rows: Blog[] = await r.json();\n+  return rows.filter(b => b.slug !== currentSlug).slice(0, 4);\n }\n \n-// ---- SEO ----\n export async function generateMetadata({ params }: { params: { slug: string } }) {\n-  try {\n-    const blog = await fetchJSON<Blog>(`${API}/api/blogs/${params.slug}`, 60);\n-    return {\n-      title: blog.metaTitle || blog.title,\n-      description: blog.metaDescription || blog.title,\n-      openGraph: {\n-        title: blog.metaTitle || blog.title,\n-        description: blog.metaDescription || blog.title,\n-        type: \"article\",\n-        url: `/blog/${blog.slug}`,\n-        images: blog.mainImage?.url ? [{ url: blog.mainImage.url }] : undefined,\n-      },\n-    };\n-  } catch {\n-    return { title: \"Not found\" };\n-  }\n+  const blog = await getBlog(params.slug);\n+  if (!blog) return {};\n+  return {\n+    title: `${blog.title} || Drozy - Modern Blog & Magazine`,\n+    description: blog.category?.name || \"Blog article\",\n+    openGraph: {\n+      title: blog.title,\n+      description: blog.category?.name || \"Blog article\",\n+      type: \"article\",\n+      url: `/blog/${blog.slug}`,\n+      images: blog.mainImage?.url ? [blog.mainImage.url] : undefined,\n+    },\n+  };\n }\n \n-// ---- page ----\n export default async function Page({ params }: { params: { slug: string } }) {\n-  // 1) current post\n-  let blog: Blog | null = null;\n-  try {\n-    blog = await fetchJSON<Blog>(`${API}/api/blogs/${params.slug}`, 60);\n-  } catch {\n-    return notFound();\n-  }\n+  const blog = await getBlog(params.slug);\n   if (!blog) return notFound();\n \n-  // 2) load some recent posts to compute prev/next + related\n-  const all = await fetchJSON<Blog[]>(`${API}/api/blogs?limit=50`, 60);\n+  const related = await getRelated(blog.category?.slug, blog.slug);\n \n-  // sort newest -> oldest\n-  const sorted = [...all].sort(\n-    (a, b) => new Date(b.createdAt || 0).getTime() - new Date(a.createdAt || 0).getTime()\n-  );\n-  const idx = sorted.findIndex((p) => p.slug === blog!.slug);\n-  const prevBlog = idx > 0 ? sorted[idx - 1] : null;\n-  const nextBlog = idx >= 0 && idx < sorted.length - 1 ? sorted[idx + 1] : null;\n-\n-  // 3) related by category (exclude current)\n-  const related = sorted\n-    .filter(\n-      (p) =>\n-        p.slug !== blog!.slug &&\n-        (p.category?._id && blog!.category?._id\n-          ? p.category!._id === blog!.category!._id\n-          : p.category?.name === blog!.category?.name)\n-    )\n-    .slice(0, 6);\n-\n   return (\n     <>\n       <Header1 />\n \n       {/* breadcrumb */}\n       <div className=\"bg-surface2-color\">\n         <div className=\"tf-container\">\n           <ul className=\"breadcrumb text-caption-1 text_on-surface-color\">\n+            <li><Link href=\"/\" className=\"link\">Home</Link></li>\n             <li>\n-              <Link href=\"/\" className=\"link\">Home</Link>\n-            </li>\n-            <li>\n-              {/* If you build a real category page later, swap the href */}\n-              <Link href={`/categories-1`} className=\"link\">\n+              <Link href=\"/categories-1\" className=\"link\">\n                 {blog.category?.name || \"Category\"}\n               </Link>\n             </li>\n             <li>{blog.title}</li>\n           </ul>\n         </div>\n       </div>\n \n-      {/* heading-post */}\n+      {/* heading-post (hero) */}\n       <div className=\"heading-post style-1\">\n         <div className=\"tf-container\">\n           <div className=\"post-inner\">\n             <div className=\"content\">\n               <div className=\"wrap-meta-feature d-flex align-items-center\">\n                 <span className=\"tag\">\n                   <a className=\"text-title text_white\">\n-                    {blog.category?.name || \"General\"}\n+                    {blog.category?.name || \"CATEGORY\"}\n                   </a>\n                 </span>\n                 <ul className=\"meta-feature fw-7 d-flex mb_16 text-body-1 mb-0 align-items-center\">\n-                  <li>{new Date(blog.createdAt || \"\").toDateString()}</li>\n                   <li>\n+                    {new Date(blog.createdAt || Date.now()).toLocaleDateString(\n+                      undefined,\n+                      { year: \"numeric\", month: \"long\", day: \"numeric\" }\n+                    )}\n+                  </li>\n+                  <li>\n                     <span className=\"text_secodary2-color\">POST BY</span>{\" \"}\n-                    <a className=\"link\">{blog.postedBy || \"Admin\"}</a>\n+                    <a className=\"link\">{blog.postedBy || \"Author\"}</a>\n                   </li>\n                 </ul>\n               </div>\n               <h1 className=\"mb_20\">{blog.title}</h1>\n-\n               <div className=\"user-post d-flex align-items-center gap_20\">\n                 <div className=\"avatar\">\n                   <img alt=\"avatar\" src=\"/images/avatar/avatar-1.jpg\" width={100} height={100} />\n                 </div>\n                 <p className=\"fw-7\">\n                   <span className=\"text_secodary2-color\">Post by</span>{\" \"}\n-                  <a className=\"link\">{blog.postedBy || \"Admin\"}</a>\n+                  <a className=\"link\">{blog.postedBy || \"Author\"}</a>\n                 </p>\n               </div>\n             </div>\n \n-            {blog.mainImage?.url && (\n-              <div className=\"thumbs-post\">\n-                <Image\n-                  className=\"lazyload\"\n-                  alt={blog.title}\n-                  src={blog.mainImage.url}\n-                  width={1350}\n-                  height={1013}\n-                  style={{ maxHeight: \"100vh\", objectFit: \"contain\" }}\n-                  priority\n-                />\n-              </div>\n-            )}\n+            <div className=\"thumbs-post\">\n+              <Image\n+                className=\"lazyload\"\n+                alt={blog.title}\n+                src={blog.mainImage?.url || \"/images/feature-post/thumbs-main-post-1.webp\"}\n+                width={1350}\n+                height={1013}\n+                style={{ maxHeight: \"100vh\", objectFit: \"contain\" }}\n+              />\n+            </div>\n           </div>\n         </div>\n       </div>\n \n-      {/* main */}\n+      {/* main content grid */}\n       <div className=\"main-content\">\n         <div className=\"single-post style-1\">\n           <div className=\"tf-container\">\n             <div className=\"row\">\n-              {/* share bar (left) */}\n+              {/* left share column */}\n               <div className=\"col-lg-2 lg-hide\">\n                 <div className=\"share-bar style-1 text-center sticky-top\">\n                   <h5 className=\"mb_20\">Share This Post</h5>\n                   <ul className=\"d-grid gap_10\">\n@@ -188,74 +145,56 @@\n                   </ul>\n                 </div>\n               </div>\n \n-              {/* content + sidebar */}\n-              <div className=\"col-lg-10\">\n+              {/* center: article + comments/form */}\n+              <div className=\"col-lg-7\">\n                 <div className=\"content-inner\">\n                   <div className=\"wrap-post-details\">\n-                    <div\n-                      className=\"post-details\"\n-                      dangerouslySetInnerHTML={{ __html: blog.contentHtml || \"\" }}\n-                    />\n+                    <div className=\"post-details\">\n+                      {/* render HTML from the editor */}\n+                      <div\n+                        className=\"post-details__html\"\n+                        dangerouslySetInnerHTML={{ __html: blog.contentHtml }}\n+                      />\n+                    </div>\n \n-                    {/* prev / next */}\n-                    <div className=\"tf-article-navigation\">\n-                      {prevBlog ? (\n-                        <div className=\"item prev\">\n-                          <Link\n-                            href={`/blog/${prevBlog.slug}`}\n-                            className=\"hover-underline-link text-body-1 text_on-surface-color fw-7 mb_12\"\n-                          >\n-                            Previous\n-                          </Link>\n-                          <h6>\n-                            <Link href={`/blog/${prevBlog.slug}`} className=\"link line-clamp-2\">\n-                              {prevBlog.title}\n-                            </Link>\n-                          </h6>\n-                        </div>\n-                      ) : null}\n+                    {/* Prev/Next (optional simple) */}\n+                    {/* keep your existing nav if you want; omitted here to stay focused */}\n+                  </div>\n \n-                      {nextBlog ? (\n-                        <div className=\"item next\">\n-                          <Link\n-                            href={`/blog/${nextBlog.slug}`}\n-                            className=\"hover-underline-link text-body-1 text_on-surface-color fw-7 mb_12\"\n-                          >\n-                            Next\n-                          </Link>\n-                          <h6>\n-                            <Link href={`/blog/${nextBlog.slug}`} className=\"link line-clamp-2\">\n-                              {nextBlog.title}\n-                            </Link>\n-                          </h6>\n-                        </div>\n-                      ) : null}\n+                  {/* Comments + form block from your template */}\n+                  <div className=\"row mt_40\">\n+                    <div className=\"col-lg-12\">\n+                      {/* Your Comment component already renders the two-column (list + form) block */}\n+                      {/* If yours expects props, wire them here. */}\n+                      {/* <Comment /> */}\n                     </div>\n                   </div>\n-\n-                  {/* comments + sidebar (keep your existing components) */}\n-                  <Comment />\n-                  <Sidebar />\n                 </div>\n               </div>\n+\n+              {/* right: sidebar */}\n+              <div className=\"col-lg-3\">\n+                <Sidebar />\n+              </div>\n             </div>\n           </div>\n         </div>\n \n-        {/* Related Posts by category */}\n-        <div className=\"tf-container\">\n-          <div className=\"heading-section mb_28\">\n-            <h3 className=\"title\">Related Posts</h3>\n-          </div>\n-          <div className=\"tf-grid-layout xxl-col-4 sm-col-2\">\n-            {related.map((b) => {\n-              const card = toCardPost(b);\n-              return <BlogCard1 key={b._id} post={card as any} />;\n-            })}\n-          </div>\n-        </div>\n+        {/* related by category */}\n+        <RelatedBlogs\n+          // expects array of posts shaped like your cards\n+          posts={related.map((b) => ({\n+            id: b._id,\n+            title: b.title,\n+            author: b.postedBy || \"\",\n+            imgSrc: b.mainImage?.url || \"\",\n+            category: b.category?.name || \"\",\n+            href: `/blog/${b.slug}`,\n+          }))}\n+          title=\"Related Posts\"\n+        />\n       </div>\n \n       <Footer1 parentClass=\"tf-container\" />\n     </>\n"
                },
                {
                    "date": 1762456018305,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -6,9 +6,10 @@\n import Header1 from \"@/components/headers/Header1\";\n import Footer1 from \"@/components/footers/Footer1\";\n import Sidebar from \"@/components/blog-single/Sidebar\";\n import SocialShare2 from \"@/components/blog-single/SocialShare2\";\n-import RelatedBlogs from \"@/components/blog-single/RelatedBlogs\";\n+import Comment from \"@/components/blog-single/Comment\";\n+import BlogCard1 from \"@/components/blog-cards/BlogCard1\";\n \n type Blog = {\n   _id: string;\n   slug: string;\n@@ -21,28 +22,32 @@\n };\n \n const API = process.env.NEXT_PUBLIC_API_BASE!;\n \n-async function getBlog(slug: string): Promise<Blog | null> {\n+// ------- helpers -------\n+async function fetchBlog(slug: string): Promise<Blog | null> {\n   const r = await fetch(`${API}/api/blogs/${slug}`, { cache: \"no-store\" });\n   if (!r.ok) return null;\n   return r.json();\n }\n \n-// simple related by same category (exclude current)\n-async function getRelated(categorySlug?: string, currentSlug?: string) {\n-  if (!categorySlug) return [];\n-  const r = await fetch(\n-    `${API}/api/blogs?category=${encodeURIComponent(categorySlug)}&limit=6`,\n-    { cache: \"no-store\" }\n-  );\n+// We fetch a chunk then filter by category locally (your backend list route\n+// doesnâ€™t support ?category yet).\n+async function fetchRelated(catName?: string, catSlug?: string, currentSlug?: string) {\n+  const r = await fetch(`${API}/api/blogs?limit=100`, { cache: \"no-store\" });\n   if (!r.ok) return [];\n   const rows: Blog[] = await r.json();\n-  return rows.filter(b => b.slug !== currentSlug).slice(0, 4);\n+  return rows\n+    .filter(\n+      (b) =>\n+        b.slug !== currentSlug &&\n+        (b.category?.slug === catSlug || b.category?.name === catName)\n+    )\n+    .slice(0, 4);\n }\n \n export async function generateMetadata({ params }: { params: { slug: string } }) {\n-  const blog = await getBlog(params.slug);\n+  const blog = await fetchBlog(params.slug);\n   if (!blog) return {};\n   return {\n     title: `${blog.title} || Drozy - Modern Blog & Magazine`,\n     description: blog.category?.name || \"Blog article\",\n@@ -55,13 +60,18 @@\n     },\n   };\n }\n \n+// ------- page -------\n export default async function Page({ params }: { params: { slug: string } }) {\n-  const blog = await getBlog(params.slug);\n+  const blog = await fetchBlog(params.slug);\n   if (!blog) return notFound();\n \n-  const related = await getRelated(blog.category?.slug, blog.slug);\n+  const related = await fetchRelated(\n+    blog.category?.name,\n+    blog.category?.slug,\n+    blog.slug\n+  );\n \n   return (\n     <>\n       <Header1 />\n@@ -69,10 +79,12 @@\n       {/* breadcrumb */}\n       <div className=\"bg-surface2-color\">\n         <div className=\"tf-container\">\n           <ul className=\"breadcrumb text-caption-1 text_on-surface-color\">\n-            <li><Link href=\"/\" className=\"link\">Home</Link></li>\n             <li>\n+              <Link href=\"/\" className=\"link\">Home</Link>\n+            </li>\n+            <li>\n               <Link href=\"/categories-1\" className=\"link\">\n                 {blog.category?.name || \"Category\"}\n               </Link>\n             </li>\n@@ -80,25 +92,22 @@\n           </ul>\n         </div>\n       </div>\n \n-      {/* heading-post (hero) */}\n+      {/* hero */}\n       <div className=\"heading-post style-1\">\n         <div className=\"tf-container\">\n           <div className=\"post-inner\">\n             <div className=\"content\">\n               <div className=\"wrap-meta-feature d-flex align-items-center\">\n                 <span className=\"tag\">\n-                  <a className=\"text-title text_white\">\n-                    {blog.category?.name || \"CATEGORY\"}\n-                  </a>\n+                  <a className=\"text-title text_white\">{blog.category?.name || \"CATEGORY\"}</a>\n                 </span>\n                 <ul className=\"meta-feature fw-7 d-flex mb_16 text-body-1 mb-0 align-items-center\">\n                   <li>\n-                    {new Date(blog.createdAt || Date.now()).toLocaleDateString(\n-                      undefined,\n-                      { year: \"numeric\", month: \"long\", day: \"numeric\" }\n-                    )}\n+                    {new Date(blog.createdAt || Date.now()).toLocaleDateString(undefined, {\n+                      year: \"numeric\", month: \"long\", day: \"numeric\",\n+                    })}\n                   </li>\n                   <li>\n                     <span className=\"text_secodary2-color\">POST BY</span>{\" \"}\n                     <a className=\"link\">{blog.postedBy || \"Author\"}</a>\n@@ -130,14 +139,14 @@\n           </div>\n         </div>\n       </div>\n \n-      {/* main content grid */}\n+      {/* main grid (keeps template layout) */}\n       <div className=\"main-content\">\n         <div className=\"single-post style-1\">\n           <div className=\"tf-container\">\n             <div className=\"row\">\n-              {/* left share column */}\n+              {/* left share */}\n               <div className=\"col-lg-2 lg-hide\">\n                 <div className=\"share-bar style-1 text-center sticky-top\">\n                   <h5 className=\"mb_20\">Share This Post</h5>\n                   <ul className=\"d-grid gap_10\">\n@@ -145,56 +154,57 @@\n                   </ul>\n                 </div>\n               </div>\n \n-              {/* center: article + comments/form */}\n+              {/* center column: article + comments */}\n               <div className=\"col-lg-7\">\n                 <div className=\"content-inner\">\n                   <div className=\"wrap-post-details\">\n                     <div className=\"post-details\">\n-                      {/* render HTML from the editor */}\n                       <div\n                         className=\"post-details__html\"\n                         dangerouslySetInnerHTML={{ __html: blog.contentHtml }}\n                       />\n                     </div>\n-\n-                    {/* Prev/Next (optional simple) */}\n-                    {/* keep your existing nav if you want; omitted here to stay focused */}\n                   </div>\n \n-                  {/* Comments + form block from your template */}\n-                  <div className=\"row mt_40\">\n-                    <div className=\"col-lg-12\">\n-                      {/* Your Comment component already renders the two-column (list + form) block */}\n-                      {/* If yours expects props, wire them here. */}\n-                      {/* <Comment /> */}\n-                    </div>\n-                  </div>\n+                  {/* COMMENTS + FORM (from your template) */}\n+                  <Comment />\n                 </div>\n               </div>\n \n-              {/* right: sidebar */}\n+              {/* right sidebar */}\n               <div className=\"col-lg-3\">\n                 <Sidebar />\n               </div>\n             </div>\n           </div>\n         </div>\n \n-        {/* related by category */}\n-        <RelatedBlogs\n-          // expects array of posts shaped like your cards\n-          posts={related.map((b) => ({\n-            id: b._id,\n-            title: b.title,\n-            author: b.postedBy || \"\",\n-            imgSrc: b.mainImage?.url || \"\",\n-            category: b.category?.name || \"\",\n-            href: `/blog/${b.slug}`,\n-          }))}\n-          title=\"Related Posts\"\n-        />\n+        {/* Related Posts (dynamic by category) */}\n+        {related.length > 0 && (\n+          <div className=\"tf-container mt_40\">\n+            <div className=\"heading-section mb_28\">\n+              <h3 className=\"title\">Related Posts</h3>\n+            </div>\n+            <div className=\"tf-grid-layout lg-col-3\">\n+              {related.map((b) => (\n+                <BlogCard1\n+                  key={b._id}\n+                  post={{\n+                    id: b._id,\n+                    title: b.title,\n+                    author: b.postedBy || \"\",\n+                    category: b.category?.name || \"\",\n+                    date: new Date(b.createdAt || Date.now()).toLocaleDateString(),\n+                    imgSrc: b.mainImage?.url || \"\",\n+                    href: `/blog/${b.slug}`,\n+                  }}\n+                />\n+              ))}\n+            </div>\n+          </div>\n+        )}\n       </div>\n \n       <Footer1 parentClass=\"tf-container\" />\n     </>\n"
                },
                {
                    "date": 1762456312703,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -166,10 +166,9 @@\n                       />\n                     </div>\n                   </div>\n \n-                  {/* COMMENTS + FORM (from your template) */}\n-                  <Comment />\n+                  \n                 </div>\n               </div>\n \n               {/* right sidebar */}\n"
                },
                {
                    "date": 1762456445106,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -164,8 +164,10 @@\n                         className=\"post-details__html\"\n                         dangerouslySetInnerHTML={{ __html: blog.contentHtml }}\n                       />\n                     </div>\n+                    {/* COMMENTS + FORM (from your template) */}\n+                  <Comment />\n                   </div>\n \n                   \n                 </div>\n@@ -180,9 +182,9 @@\n         </div>\n \n         {/* Related Posts (dynamic by category) */}\n         {related.length > 0 && (\n-          <div className=\"tf-container mt_40\">\n+          <div className=\"tf-container sw-layout tf-spacing-8\">\n             <div className=\"heading-section mb_28\">\n               <h3 className=\"title\">Related Posts</h3>\n             </div>\n             <div className=\"tf-grid-layout lg-col-3\">\n"
                },
                {
                    "date": 1762458601486,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -165,9 +165,9 @@\n                         dangerouslySetInnerHTML={{ __html: blog.contentHtml }}\n                       />\n                     </div>\n                     {/* COMMENTS + FORM (from your template) */}\n-                  <Comment />\n+                  <Comment postId={blog._id}/>\n                   </div>\n \n                   \n                 </div>\n"
                },
                {
                    "date": 1762541129442,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -80,9 +80,9 @@\n       <div className=\"bg-surface2-color\">\n         <div className=\"tf-container\">\n           <ul className=\"breadcrumb text-caption-1 text_on-surface-color\">\n             <li>\n-              <Link href=\"/\" className=\"link\">Home</Link>\n+              <Link href=\"/\" className=\"link\">Homedscx</Link>\n             </li>\n             <li>\n               <Link href=\"/categories-1\" className=\"link\">\n                 {blog.category?.name || \"Category\"}\n"
                },
                {
                    "date": 1762541155517,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -80,9 +80,9 @@\n       <div className=\"bg-surface2-color\">\n         <div className=\"tf-container\">\n           <ul className=\"breadcrumb text-caption-1 text_on-surface-color\">\n             <li>\n-              <Link href=\"/\" className=\"link\">Homedscx</Link>\n+              <Link href=\"/\" className=\"link\">Home</Link>\n             </li>\n             <li>\n               <Link href=\"/categories-1\" className=\"link\">\n                 {blog.category?.name || \"Category\"}\n"
                },
                {
                    "date": 1762629257528,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -207,7 +207,15 @@\n         )}\n       </div>\n \n       <Footer1 parentClass=\"tf-container\" />\n+\n+      {post.schemaMarkup && (\n+  <script\n+    type=\"application/ld+json\"\n+    dangerouslySetInnerHTML={{ __html: post.schemaMarkup }}\n+  />\n+)}\n+\n     </>\n   );\n }\n"
                },
                {
                    "date": 1762629279171,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -208,14 +208,8 @@\n       </div>\n \n       <Footer1 parentClass=\"tf-container\" />\n \n-      {post.schemaMarkup && (\n-  <script\n-    type=\"application/ld+json\"\n-    dangerouslySetInnerHTML={{ __html: post.schemaMarkup }}\n-  />\n-)}\n-\n+      \n     </>\n   );\n }\n"
                },
                {
                    "date": 1762629833689,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -18,8 +18,9 @@\n   mainImage?: { url?: string };\n   contentHtml: string;\n   category?: { name: string; slug?: string };\n   createdAt?: string;\n+  schemaMarkup?: string;\n };\n \n const API = process.env.NEXT_PUBLIC_API_BASE!;\n \n"
                },
                {
                    "date": 1762629840545,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,9 @@\n // app/blog/[slug]/page.tsx\n import Link from \"next/link\";\n import Image from \"next/image\";\n import { notFound } from \"next/navigation\";\n+import Script from \"next/script\";\n \n import Header1 from \"@/components/headers/Header1\";\n import Footer1 from \"@/components/footers/Footer1\";\n import Sidebar from \"@/components/blog-single/Sidebar\";\n"
                },
                {
                    "date": 1762629858295,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -76,8 +76,17 @@\n \n   return (\n     <>\n       <Header1 />\n+      {/* JSON-LD (from backend textarea) */}\n+{blog.schemaMarkup ? (\n+  <Script\n+    id={`schema-${blog.slug}`}\n+    type=\"application/ld+json\"\n+    strategy=\"afterInteractive\"\n+    dangerouslySetInnerHTML={{ __html: blog.schemaMarkup }}\n+  />\n+) : null}\n \n       {/* breadcrumb */}\n       <div className=\"bg-surface2-color\">\n         <div className=\"tf-container\">\n"
                }
            ],
            "date": 1762454339262,
            "name": "Commit-0",
            "content": "// app/blog/[slug]/page.tsx\nimport Image from \"next/image\";\nimport Link from \"next/link\";\nimport { notFound } from \"next/navigation\";\n\nimport Header1 from \"@/components/headers/Header1\";\nimport Footer1 from \"@/components/footers/Footer1\";\nimport Sidebar from \"@/components/blog-single/Sidebar\";\nimport SocialShare2 from \"@/components/blog-single/SocialShare2\";\nimport Comment from \"@/components/blog-single/Comment\";\nimport BlogCard1 from \"@/components/blog-cards/BlogCard1\";\n\ntype Blog = {\n  _id: string;\n  slug: string;\n  title: string;\n  postedBy?: string;\n  mainImage?: { url?: string };\n  category?: { name?: string; slug?: string; _id?: string };\n  contentHtml?: string;\n  createdAt?: string;\n  metaTitle?: string;\n  metaDescription?: string;\n};\n\nconst API = process.env.NEXT_PUBLIC_API_BASE!;\n\n// ---- helpers ----\nasync function fetchJSON<T>(url: string, revalidate = 120): Promise<T> {\n  const res = await fetch(url, { next: { revalidate } });\n  if (res.status === 404) throw new Error(\"404\");\n  if (!res.ok) throw new Error(await res.text());\n  return res.json();\n}\n\nfunction toCardPost(b: Blog) {\n  const imageUrl = b.mainImage?.url || \"\";\n  return {\n    id: b._id,                 // widget may read id but we link with slug\n    slug: b.slug,\n    href: `/blog/${b.slug}`,\n    title: b.title,\n    author: b.postedBy || \"\",\n    date: new Date(b.createdAt || \"\").toDateString(),\n    category: b.category?.name || \"\",\n    imgSrc: imageUrl,\n    image: imageUrl,\n    img: imageUrl,\n    thumb: imageUrl,\n  };\n}\n\n// ---- SEO ----\nexport async function generateMetadata({ params }: { params: { slug: string } }) {\n  try {\n    const blog = await fetchJSON<Blog>(`${API}/api/blogs/${params.slug}`, 60);\n    return {\n      title: blog.metaTitle || blog.title,\n      description: blog.metaDescription || blog.title,\n      openGraph: {\n        title: blog.metaTitle || blog.title,\n        description: blog.metaDescription || blog.title,\n        type: \"article\",\n        url: `/blog/${blog.slug}`,\n        images: blog.mainImage?.url ? [{ url: blog.mainImage.url }] : undefined,\n      },\n    };\n  } catch {\n    return { title: \"Not found\" };\n  }\n}\n\n// ---- page ----\nexport default async function Page({ params }: { params: { slug: string } }) {\n  // 1) current post\n  let blog: Blog | null = null;\n  try {\n    blog = await fetchJSON<Blog>(`${API}/api/blogs/${params.slug}`, 60);\n  } catch {\n    return notFound();\n  }\n  if (!blog) return notFound();\n\n  // 2) load some recent posts to compute prev/next + related\n  const all = await fetchJSON<Blog[]>(`${API}/api/blogs?limit=50`, 60);\n\n  // sort newest -> oldest\n  const sorted = [...all].sort(\n    (a, b) => new Date(b.createdAt || 0).getTime() - new Date(a.createdAt || 0).getTime()\n  );\n  const idx = sorted.findIndex((p) => p.slug === blog!.slug);\n  const prevBlog = idx > 0 ? sorted[idx - 1] : null;\n  const nextBlog = idx >= 0 && idx < sorted.length - 1 ? sorted[idx + 1] : null;\n\n  // 3) related by category (exclude current)\n  const related = sorted\n    .filter(\n      (p) =>\n        p.slug !== blog!.slug &&\n        (p.category?._id && blog!.category?._id\n          ? p.category!._id === blog!.category!._id\n          : p.category?.name === blog!.category?.name)\n    )\n    .slice(0, 6);\n\n  return (\n    <>\n      <Header1 />\n\n      {/* breadcrumb */}\n      <div className=\"bg-surface2-color\">\n        <div className=\"tf-container\">\n          <ul className=\"breadcrumb text-caption-1 text_on-surface-color\">\n            <li>\n              <Link href=\"/\" className=\"link\">Home</Link>\n            </li>\n            <li>\n              {/* If you build a real category page later, swap the href */}\n              <Link href={`/categories-1`} className=\"link\">\n                {blog.category?.name || \"Category\"}\n              </Link>\n            </li>\n            <li>{blog.title}</li>\n          </ul>\n        </div>\n      </div>\n\n      {/* heading-post */}\n      <div className=\"heading-post style-1\">\n        <div className=\"tf-container\">\n          <div className=\"post-inner\">\n            <div className=\"content\">\n              <div className=\"wrap-meta-feature d-flex align-items-center\">\n                <span className=\"tag\">\n                  <a className=\"text-title text_white\">\n                    {blog.category?.name || \"General\"}\n                  </a>\n                </span>\n                <ul className=\"meta-feature fw-7 d-flex mb_16 text-body-1 mb-0 align-items-center\">\n                  <li>{new Date(blog.createdAt || \"\").toDateString()}</li>\n                  <li>\n                    <span className=\"text_secodary2-color\">POST BY</span>{\" \"}\n                    <a className=\"link\">{blog.postedBy || \"Admin\"}</a>\n                  </li>\n                </ul>\n              </div>\n              <h1 className=\"mb_20\">{blog.title}</h1>\n\n              <div className=\"user-post d-flex align-items-center gap_20\">\n                <div className=\"avatar\">\n                  <img alt=\"avatar\" src=\"/images/avatar/avatar-1.jpg\" width={100} height={100} />\n                </div>\n                <p className=\"fw-7\">\n                  <span className=\"text_secodary2-color\">Post by</span>{\" \"}\n                  <a className=\"link\">{blog.postedBy || \"Admin\"}</a>\n                </p>\n              </div>\n            </div>\n\n            {blog.mainImage?.url && (\n              <div className=\"thumbs-post\">\n                <Image\n                  className=\"lazyload\"\n                  alt={blog.title}\n                  src={blog.mainImage.url}\n                  width={1350}\n                  height={1013}\n                  style={{ maxHeight: \"100vh\", objectFit: \"contain\" }}\n                  priority\n                />\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* main */}\n      <div className=\"main-content\">\n        <div className=\"single-post style-1\">\n          <div className=\"tf-container\">\n            <div className=\"row\">\n              {/* share bar (left) */}\n              <div className=\"col-lg-2 lg-hide\">\n                <div className=\"share-bar style-1 text-center sticky-top\">\n                  <h5 className=\"mb_20\">Share This Post</h5>\n                  <ul className=\"d-grid gap_10\">\n                    <SocialShare2 />\n                  </ul>\n                </div>\n              </div>\n\n              {/* content + sidebar */}\n              <div className=\"col-lg-10\">\n                <div className=\"content-inner\">\n                  <div className=\"wrap-post-details\">\n                    <div\n                      className=\"post-details\"\n                      dangerouslySetInnerHTML={{ __html: blog.contentHtml || \"\" }}\n                    />\n\n                    {/* prev / next */}\n                    <div className=\"tf-article-navigation\">\n                      {prevBlog ? (\n                        <div className=\"item prev\">\n                          <Link\n                            href={`/blog/${prevBlog.slug}`}\n                            className=\"hover-underline-link text-body-1 text_on-surface-color fw-7 mb_12\"\n                          >\n                            Previous\n                          </Link>\n                          <h6>\n                            <Link href={`/blog/${prevBlog.slug}`} className=\"link line-clamp-2\">\n                              {prevBlog.title}\n                            </Link>\n                          </h6>\n                        </div>\n                      ) : null}\n\n                      {nextBlog ? (\n                        <div className=\"item next\">\n                          <Link\n                            href={`/blog/${nextBlog.slug}`}\n                            className=\"hover-underline-link text-body-1 text_on-surface-color fw-7 mb_12\"\n                          >\n                            Next\n                          </Link>\n                          <h6>\n                            <Link href={`/blog/${nextBlog.slug}`} className=\"link line-clamp-2\">\n                              {nextBlog.title}\n                            </Link>\n                          </h6>\n                        </div>\n                      ) : null}\n                    </div>\n                  </div>\n\n                  {/* comments + sidebar (keep your existing components) */}\n                  <Comment />\n                  <Sidebar />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        {/* Related Posts by category */}\n        <div className=\"tf-container\">\n          <div className=\"heading-section mb_28\">\n            <h3 className=\"title\">Related Posts</h3>\n          </div>\n          <div className=\"tf-grid-layout xxl-col-4 sm-col-2\">\n            {related.map((b) => {\n              const card = toCardPost(b);\n              return <BlogCard1 key={b._id} post={card as any} />;\n            })}\n          </div>\n        </div>\n      </div>\n\n      <Footer1 parentClass=\"tf-container\" />\n    </>\n  );\n}\n"
        }
    ]
}